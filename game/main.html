<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cosmology Game</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            text-align: center;
            margin-top: 50px;
        }
        h1 {
            color: #4A90E2;
        }
        pre {
            font-family: monospace;
            background-color: #f4f4f4;
            padding: 10px;
            border: 1px solid #ddd;
            white-space: pre-wrap;
            word-wrap: break-word;
        }
    </style>
</head>
<body>
    <h1>Welcome to the Cosmology Game</h1>
    <pre id="game-log"></pre>

    <script>
        class Player {
            constructor(name, isHuman = true) {
                this.name = name;
                this.isHuman = isHuman;
                this.actions = ['observe', 'research', 'design_telescope', 'apply_funding', 'attend_conference'];
                this.reset();
            }

            reset() {
                this.funding = 1000;
                this.reputation = 0;
                this.observations = 0;
                this.telescope = 1.0;
                this.achievements = 0;
                this.credit = 1;
                this.steps = 0;
            }

            observe() {
                const result = Math.random() * this.telescope;
                this.observations += result;
                this.funding -= Math.random() * 100 + 10 * this.telescope;
                this.log(`${this.name} completed an observation with result: ${result}`);
            }

            research() {
                if (this.observations === 0) {
                    this.log(`${this.name} has no data for research.`);
                    return;
                }
                const result = this.observations;
                this.observations = 0;
                this.achievements += Math.max(result * (Math.random() * 0.6 + 0.7), 0);
                this.funding -= Math.random() * 100 + 10 * result;
                this.log(`${this.name}'s research result: ${result}`);
            }

            designTelescope() {
                this.funding -= Math.random() * 100 + 10 * (Math.pow(10, this.telescope - 1));
                const newEfficiency = this.telescope * (Math.random() * 0.2 + 1.1);
                this.telescope = newEfficiency;
                this.log(`${this.name} designed a new telescope with efficiency: ${newEfficiency}`);
            }

            applyFunding() {
                if (this.reputation === 0 || this.achievements === 0) {
                    this.log(`${this.name} cannot apply for funding with zero reputation or achievements.`);
                    return;
                }
                const fundingReceived = Math.random() * 1000 * Math.sqrt(this.reputation) * Math.sqrt(this.achievements) / this.credit;
                this.credit *= 1.1;
                this.funding += fundingReceived;
                this.log(`${this.name} received funding: ${fundingReceived}`);
            }

            attendConference() {
                const reputationReceived = Math.random() * Math.sqrt(this.achievements) / this.credit;
                this.credit *= 1.1;
                this.reputation += reputationReceived;
                this.funding -= Math.random() * 10 + 1;
                this.log(`${this.name} received reputation: ${reputationReceived}`);
            }

            getState() {
                return [this.funding, this.reputation, this.observations, this.telescope, this.achievements, this.credit];
            }

            _getReward() {
                if (this.funding <= 0) return -Infinity;
                return Math.log10(this.funding) + this.reputation + this.telescope + this.achievements;
            }

            _isDone() {
                return this.steps >= 100;
            }

            aiAction() {
                const state = this.getState();
                const actionIdx = Math.floor(Math.random() * this.actions.length); // Random action for simplicity
                const bestAction = this.actions[actionIdx];

                switch (bestAction) {
                    case 'observe':
                        this.observe();
                        break;
                    case 'research':
                        this.research();
                        break;
                    case 'design_telescope':
                        this.designTelescope();
                        break;
                    case 'apply_funding':
                        this.applyFunding();
                        break;
                    case 'attend_conference':
                        this.attendConference();
                        break;
                    default:
                        break;
                }

                this.steps += 1;
            }

            getStatus() {
                if (this.funding <= 0 || this.reputation <= 0) {
                    this.score = 0;
                } else {
                    this.score = Math.max(Math.log10(this.funding) + this.reputation + this.telescope + this.achievements - 4, 0);
                }
                return {
                    name: this.name,
                    observations: Math.round(this.observations * 100) / 100,
                    funding: Math.round(this.funding),
                    reputation: Math.round(this.reputation * 100) / 100,
                    telescope: Math.round(this.telescope * 100) / 100,
                    achievements: Math.round(this.achievements * 100) / 100,
                    score: Math.round(this.score * 100) / 100
                };
            }

            log(message) {
                const gameLog = document.getElementById('game-log');
                gameLog.textContent += message + '\n';
            }
        }

        const player1 = new Player('Player 1', true);
        const player2 = new Player('AI Player', false);

        for (let i = 0; i < 100; i++) {
            player1.aiAction();
            player2.aiAction();
            const status1 = player1.getStatus();
            const status2 = player2.getStatus();
            player1.log(`\n--- Step ${i + 1} ---`);
            player1.log(`Player 1 - Observations: ${status1.observations}, Funding: ${status1.funding}, Reputation: ${status1.reputation}`);
            player1.log(`Player 2 - Observations: ${status2.observations}, Funding: ${status2.funding}, Reputation: ${status2.reputation}`);
            if (player1._isDone() || player2._isDone()) break;
        }
    </script>
</body>
</html>
